# Launch GCE Instance on Centos
---
- name: Launch GCE Instance
  gce:
    name: "{{size}}-{{lookup('pipe','date +%s')}}"
    zone: "{{region}}"
    machine_type: "{{instance_type}}"
    image: "{{gce_image}}"
    state: present
    disk_size: 10
    num_instances: "{{count}}"
    tags:
      - "{{benchmark}}"
  register: gce

- name: Wait for SSH
  wait_for:
    host: "{{ item.public_ip }}"
    port: 22
    state: started
  with_items: "{{ gce.instance_data }}"
