---

- name: Launch Linux Azure Instance
  azure_rm_virtualmachine:
    resource_group: "{{resource_group}}"
    os_type: Linux
    name: "{{azure_vm_name}}"
    location: "{{region}}"
    vm_size: "{{instance_type}}"
    admin_username: "{{ssh_user}}"
#    admin_password: "{{ssh_pass}}"
    managed_disk_type: Premium_LRS
    remove_on_absent:
      - network_interfaces
      - virtual_storage
      - public_ips
    ssh_public_keys:
      - path: /home/{{ssh_user}}/.ssh/authorized_keys
        key_data: "{{ssh_public_key.stdout}}"
    ssh_password_enabled: false
    image:
      offer: "{{azure_image}}"
      publisher: "{{azure_publisher}}"
      sku: "{{azure_sku}}"
      version: "{{azure_version}}"
  register: azure_vm

