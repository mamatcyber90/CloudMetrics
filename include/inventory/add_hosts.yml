---

# Add new entries to in-memory host file for subsequent plays
- name: Add AWS ips to benchmark inventory
  add_host:
    name: "{{ item.0.public_ip }}"
    ansible_user: Administrator  # AWS Windows user is always the Administrator
    ansible_password: "{{item.1}}"
    groups: "{{benchmark}}"
  with_together:
    - "{{ ec2.instances }}"
    - "{{ admin_passwords }}"
  when: cloud == "aws"

- name: Add GCE ips to benchmark inventory
  add_host:
    name: "{{ item.0.public_ip }}"
    ansible_user: winUser
    ansible_password: "{{ item.1 }}"
    groups: "{{benchmark}}"
  with_together:
    - "{{ gce.instance_data }}"
    - "{{ admin_passwords }}"
  when: cloud == "gce"

  # Had to create custom list in case there is more than one IP
- name: Add Azure ips to benchmark inventory
  add_host:
    name: "{{ item }}"
    ansible_user: "{{ssh_user}}"
    ansible_password: "{{ssh_pass}}"
    groups: "{{benchmark}}"
  with_items: "{{ azure_ips }}"
  when: cloud == "azure"
