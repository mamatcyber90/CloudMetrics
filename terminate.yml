- name: Terminate Cloud instances
  hosts: localhost
  connection: local

  # Since we are executing on localhost, the vars
  # we created in start.yml should still be active
  # As it was started all as one playbook

  tasks:

    - name: Clean up aws
      include_tasks: "{{playbook_dir}}/include/terminate/terminate_aws.yml"
      when:
        - cloud is defined
        - cloud == "aws"
        - DontTerminate is not defined

    - name: Clean up gce
      include_tasks: "{{playbook_dir}}/include/terminate/terminate_gce.yml"
      when:
        - cloud is defined
        - cloud == "gce"
        - DontTerminate is not defined

    - name: Clean up Azure
      include_tasks: "{{playbook_dir}}/include/terminate/terminate_azure.yml"
      when:
        - cloud is defined
        - cloud == "azure"
        - DontTerminate is not defined
